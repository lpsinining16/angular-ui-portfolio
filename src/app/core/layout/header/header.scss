:host {
  display: block;
}

// --- Scroll Progress Bar ---
.scroll-progress-bar-track {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background-color: var(--progress-bar-track);
  z-index: 51;
}

.scroll-progress-bar {
  height: 100%;
  width: 100%;
  background-color: var(--progress-bar-bg);
  transform-origin: left;
  transform: scaleX(0);
}

// --- Header Styles ---
header#app-bar {
  z-index: 40;
  padding: 1.25rem 1rem;
  transition: padding 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.nav-wrapper {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 0 auto;
  width: 100%;
  max-width: 1280px;
  padding: 0 2rem;
  border-radius: 9999px;
  transition: background-color 0.4s cubic-bezier(0.4, 0, 0.2, 1),
    box-shadow 0.4s cubic-bezier(0.4, 0, 0.2, 1), backdrop-filter 0.4s cubic-bezier(0.4, 0, 0.2, 1),
    padding 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

header#app-bar.shrunk .nav-wrapper {
  background-color: rgba(var(--surface-rgb), 0.8);
  @apply backdrop-blur-md;
  padding: 1rem 2rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.logo {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--primary);
  text-decoration: none;
  transition: font-size 0.4s cubic-bezier(0.4, 0, 0.2, 1);

  header#app-bar.shrunk & {
    font-size: 1.25rem;
  }
}

// --- Desktop Navigation & Controls ---
.desktop-menu {
  @apply hidden md:flex items-center gap-2;
}

/* --- THIS IS THE UPDATED SECTION --- */
.menu-link {
  padding: 0.5rem 1rem;
  border-radius: 9999px;
  font-weight: 500; /* Base font-weight */
  color: var(--text-color);
  transition: color 0.3s, background-color 0.3s, font-weight 0.3s; /* Added font-weight to transition */

  /* Style for when a user HOVERS over a link */
  &:hover {
    color: var(--primary);
    background-color: var(--primary-container);
  }

  /* NEW: Distinct, stronger style for the CURRENTLY ACTIVE link */
  &[aria-current='page'] {
    color: var(--primary);
    background-color: var(--primary-container-hover); /* Use the darker hover shade */
    font-weight: 700; /* Make the text bold */
  }
}

.contact-btn {
  @apply bg-light-primary text-white dark:bg-dark-primary-container dark:text-dark-primary;
  padding: 0.5rem 1.25rem;
  border-radius: 9999px;
  font-weight: 600;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  transition: transform 0.25s ease, box-shadow 0.25s ease;

  /* --- KEY CHANGES FOR THE NEW EFFECT --- */
  position: relative; /* Essential for positioning the halo */
  z-index: 1; /* Ensures button text is above the effect */

  &:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  /* --- The Halo Pseudo-Element --- */
  /* This creates a circular element that sits behind the button */
  &::before {
    content: '';
    position: absolute;
    /* Center it perfectly behind the button */
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border-radius: 9999px;

    /* The halo's appearance: a semi-transparent outline */
    border: 2px solid var(--primary-container);

    /* Start hidden: scaled down and invisible */
    transform: scale(0.8);
    opacity: 0;

    /* Place it behind the button's content */
    z-index: -1;

    /* This will be animated when the active state is applied */
    transition: opacity 0.3s, transform 0.3s;
  }

  /* --- NEW ACTIVE STATE --- */
  /* This rule activates the animation */
  &[aria-current='page'] {
    /* Better text contrast in dark mode */
    @apply dark:text-white;

    /* Trigger the animation on the ::before pseudo-element */
    &::before {
      animation: halo-ripple 1.5s infinite linear;
    }
  }
}

.separator {
  height: 24px;
  width: 1px;
  background-color: var(--outline-variant);
  margin: 0 0.75rem;
}

.control-btn {
  @apply flex items-center justify-center w-10 h-10 rounded-full;
  background-color: var(--primary-container);
  color: var(--primary);
  transition: background-color 0.3s, transform 0.3s;

  .icon {
    @apply w-6 h-6;
  }

  &:hover {
    background-color: var(--primary-container-hover);
    transform: scale(1.1);
  }
}

// --- Mobile Navigation ---
.mobile-toggle-btn {
  @apply md:hidden p-2 rounded-full;
  color: var(--text-color);
  transition: background-color 0.3s, color 0.3s;

  &:hover {
    background-color: var(--primary-container);
    color: var(--primary);
  }
}

.mobile-menu-panel {
  @apply md:hidden absolute top-full left-0 w-full p-4 shadow-xl;
  background-color: var(--background);
  border-bottom-left-radius: 1.5rem;
  border-bottom-right-radius: 1.5rem;
}

header#app-bar.shrunk .mobile-menu-panel {
  background-color: rgba(var(--surface-rgb), 0.95);
  @apply backdrop-blur-md;
  width: calc(100% - 2rem);
  left: 50%;
  transform: translateX(-50%);
  border-radius: 1.5rem;
  margin-top: 0.5rem;
}

.mobile-menu-nav {
  display: flex;
  flex-direction: column;

  a {
    @apply block py-3 px-4 rounded-lg text-lg;
    transition: background-color 0.2s, color 0.2s, font-weight 0.2s;
    font-weight: 500;

    &:hover {
      background-color: var(--primary-container);
      color: var(--primary);
    }

    &[aria-current='page'] {
      background-color: var(--primary-container-hover);
      color: var(--primary);
      font-weight: 700;
    }
  }
}

.mobile-controls {
  @apply mt-4 pt-4 border-t flex items-center justify-between gap-4;
  border-color: var(--outline-variant);
}

.mobile-control-btn-icon {
  @apply flex items-center justify-center w-12 h-12 rounded-full flex-shrink-0;
  background-color: var(--primary-container);
  color: var(--primary);

  .icon {
    @apply w-6 h-6 fill-none stroke-current;
    stroke-width: 2;
  }
}
